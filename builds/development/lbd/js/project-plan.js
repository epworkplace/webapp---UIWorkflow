function mission_action(e,t,o,a){var i=e,t=t,o=o,n=contract_id;"delete"==i?swal({title:"Are you sure?",text:"Do you want to delete this mission ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){$.post("/contractmission/delete-mission",{mission_id:o,cmid:t,cid:n,maction:"delete",type:a},function(e){}),swal({title:"Deleted!",text:"Mission has been deleted.",type:"success"},function(){location.reload()})}):"close"==i?swal({title:"Are you sure?",text:"Do you want to close this mission ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, close it!",closeOnConfirm:!1},function(){$.post("/contractmission/close-mission",{mission_id:o,cmid:t,contract_id:n,maction:"close",type:a},function(e){}),swal({title:"Closed!",text:"Mission has been closed.",type:"success"},function(){location.reload()})}):"freeze"==i?($("#freeze_mission").modal("show"),$("#freeze_mission .modal-header h3").html("Freeze Mission"),$("#freeze_mission .modal-body").html("Please wait loading..."),$.post("/contractmission/freeze-mission",{mid:o,cmid:t,type:a,cid:n},function(e){$("#freeze_mission .modal-body").html(e)})):"resume"==i?($("#edit_mission").modal("hide"),$("#edit_mission .modal-body").html(""),setTimeout(function(){$("#pause_mission").modal("show"),$("#pause_mission .modal-title").html("Resume Mission"),$("#pause_mission .modal-body").html("Please wait loading..."),$.post("/contractmission/pause-mission",{mid:o,cmid:t,type:a,cid:n,resume:"yes"},function(e){$("#pause_mission .modal-body").html(e)})},300)):"pause"==i||"pausecomment"==i||"delay"==i?($("#edit_mission").modal("hide"),$("#edit_mission .modal-body").html(""),$("#create_project_event").modal("hide"),$("#create_project_event .modal-body").html(""),setTimeout(function(){$("#pause_mission").modal("show"),$("#pause_mission .modal-title").html("Pause Mission"),$("#pause_mission .modal-body").html("Please wait loading..."),"pausecomment"==i?$.post("/contractmission/pause-mission",{mid:o,cmid:t,type:a,cid:n,pausecomment:"yes"},function(e){$("#pause_mission .modal-body").html(e)}):"delay"==i?($("#pause_mission .modal-title").html("Delay Mission"),$("#pause_mission .modal-body").html("Please wait loading..."),$.post("/contractmission/pause-mission",{mid:o,cmid:t,type:a,cid:n,delay:"yes"},function(e){$("#pause_mission .modal-body").html(e)})):$.post("/contractmission/pause-mission",{mid:o,cmid:t,type:a,cid:n},function(e){$("#pause_mission .modal-body").html(e)})},500)):"add"==i?($("#edit_mission .modal-body").html(""),$("#edit_mission .modal-title").html(""),$("#create_project_event").modal("hide"),$("#create_project_event .modal-body").html(""),$("#edit_mission").modal("show"),$("#edit_mission .modal-body").html("Please wait loading..."),$.get("/contractmission/add-mission",{reqaction:"add",cmid:t,mid:o,contract_id:contract_id,type:a},function(e){$("#edit_mission .modal-body").html(e),$("#edit_mission .modal-title").html("Add Mission")})):"edit"!=i&&"edit_delivery"!=i||($("#edit_mission .modal-body").html(""),$("#edit_mission .modal-title").html(""),$("#create_project_event .modal-body").html(""),$("#create_project_event .modal-body").html(""),"edit_delivery"==i?delivery="?delivery=1":delivery="",$("#edit_mission").modal("show"),$("#edit_mission .modal-body").html("Please wait loading..."),$.post("/contractmission/add-mission"+delivery,{reqaction:"edit",cmid:t,mid:o,contract_id:contract_id,type:a},function(e){$("#edit_mission .modal-body").html(e)}))}function fnCalTotalCosts(e){""==e&&(e="");var t=7950,o=parseFloat(t),a=parseFloat($("#actual_mission_turnover").val()),i=parseFloat($("#volume").val().replace(",",".")),n=$("#nb_words_1").val();isNaN(i)&&(i=1);var s=parseFloat($("#writer_cost").val().replace(",","."))+parseFloat($("#corrector_cost").val().replace(",","."));isNaN(s)&&(s=0),margin_percentage=parseFloat($("#margin_percentage").val().replace(",","."));var l=s/(1-margin_percentage/100);l=l.toFixed(5);var d=$("#package").val();if($.isNumeric(l)){if("team"==d){$(".fpack").hide(),$(".fpackteam").show();var r=parseFloat($("#team_packs").val())*parseFloat($("#team_fee").val()),c=(i*l+r).toFixed(2)}else if("user"==d){$(".fpack").hide(),$(".fpackuser").show();var c=parseFloat($("#user_fee").val()).toFixed(2)}else{$(".fpack").hide();var c=(i*l).toFixed(2)}if("yes"==$("[name='free_mission']:checked").val()){c=0}else{c.replace(".",",")}"total"==e&&"yes"!=$("[name='free_mission']:checked").val()||$("#mission_turnover").val(c),"unit"!=e&&$("#unit_price").val(l);var m=(l/n).toFixed(4);"word"!=e&&$("#price_per_word").val(m),$("#internalcost").val(s),"add"==$("#reqaction").val()?o+=parseFloat(c):(o-=a,o+=parseFloat(c));var _=o.toFixed(2);_=_.replace(".",","),$.isNumeric(o)&&($("#total_turnover").val(o),$("#total_turnover_text").html("<b>"+_+"</b>"))}}project={initFullCalendar:function(){$calendar=$("#fullCalendar"),today=new Date,y=today.getFullYear(),m=today.getMonth(),d=today.getDate(),$calendar.fullCalendar({header:{left:"title",center:"year,month,agendaWeek,listWeek,listDay",right:"prev,next today"},locale:"en",views:{listDay:{buttonText:"List day"},listWeek:{buttonText:"List week"}},defaultDate:today,businessHours:!0,editable:!1,eventLimit:!0,events:"/project-plan/contract-events?contract_id="+contract_id,eventAfterRender:function(e,t,o){$(t).attr("id","event_"+e._id)},selectable:!0,selectHelper:!0,select:function(e,t){var o=moment(e).format("YYYY-MM-DD HH:mm:ss"),a=moment(t).format("YYYY-MM-DD HH:mm:ss");$("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Create Event"),$("#create_project_event .modal-body").html("Please wait loading..."),$.get("/project-plan/create-project-event?start="+o+"&end="+a,{quote_id:quote_id,contract_id:contract_id},function(e){$("#create_project_event .modal-body").html(e)})},eventClick:function(e){if(e.url){var t=e.url;return $("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Edit Event"),$("#create_project_event .modal-body").html("Please wait loading..."),$.get(t,function(e){$("#create_project_event .modal-body").html(e)}),!1}}})},initMissionFullCalendar:function(){$calendar=$("#missionCalendar"),today=new Date,y=today.getFullYear(),m=today.getMonth(),d=today.getDate(),$calendar.fullCalendar({header:{left:"title",center:"year,month,agendaWeek,listWeek,listDay",right:"prev,next today"},locale:"en",views:{listDay:{buttonText:"List day"},listWeek:{buttonText:"List week"}},defaultDate:today,businessHours:!0,editable:!1,eventLimit:!0,events:"/project-plan/mission-events?contract_id="+contract_id+"&mission_id="+mission_id+"&cmid="+cmid+"&type="+type,eventAfterRender:function(e,t,o){$(t).attr("id","event_"+e._id)},selectable:!0,selectHelper:!0,select:function(e,t){var o=moment(e).format("YYYY-MM-DD HH:mm:ss"),a=moment(t).format("YYYY-MM-DD HH:mm:ss");$("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Create Event"),$("#create_project_event .modal-body").html("Please wait loading..."),$.get("/project-plan/create-project-event?start="+o+"&end="+a,{quote_id:quote_id,contract_id:contract_id,mission_id:mission_id},function(e){$("#create_project_event .modal-body").html(e)})},eventClick:function(e){if(e.url){var t=e.url;return"custom"==e.type?($("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Edit Event"),$("#create_project_event .modal-body").html("Please wait loading..."),$.get(t,function(e){$("#create_project_event .modal-body").html(e)})):"pause"==e.type?($("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Pause Mission"),$("#create_project_event .modal-body").html("Please wait loading..."),$.get(t,function(e){$("#create_project_event .modal-body").html(e)})):window.open(t,"taskview"),!1}}})},destroyCalendar:function(){$calendar=$("#fullCalendar"),$calendar.fullCalendar("destroy")},shareCalendar:function(e,t){var o="",a="";$("#create_project_event .modal-body").html(""),$("#create_project_event .modal-title").html(""),"undefined"!=typeof type&&(o=type),"undefined"!=typeof cmid&&(a=cmid),$("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Share Calendar"),$("#create_project_event .modal-body").html('<div class="text-center"><img src="/BO/theme/lbd/img/googlecalendar.gif"></div>'),$.get("/project-plan/share-calendar",{calendar:"google",contract_id:e,share_event_id:t,mission_id:t,type:o,cmid:a},function(e){setTimeout(function(){$("#create_project_event .modal-body").html(e)},5e3)})},createProjectEvent:function(e,t){$("#create_project_event").modal("show"),$("#create_project_event .modal-header h2").html("Create Event"),$("#create_project_event .modal-body").html("Please wait loading..."),$.get("/project-plan/create-project-event",{quote_id:quote_id,contract_id:e,mission_id:t},function(e){$("#create_project_event .modal-body").html(e)})},deleteProjectEvent:function(e){swal({title:"Are you sure?",text:"Do you want to delete this event ?",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){$.post("/project-plan/delete-project-event",{event_id:e},function(e){}),swal({title:"Deleted!",text:"Event has been deleted.",type:"success"},function(){location.reload()})})}};